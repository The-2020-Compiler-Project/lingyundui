# 过程报告2
---
### 1.完成情况
至此，本次编译原理课设的实验内容基本已经完成，实现了较为完整的编译器前端，接下来就是最后的验收和实验报告的撰写。

我个人实现的部分是语义分析四元式生成的部分，能根据通过词法分析和语法分析的程序token序列生成完整四元式，并保存在数组中传给优化的部分。
这里我设计了分析栈，将输入栈的内容加入到分析栈中，遇到符号就进行匹配。
设计最初是完成算数表达式的四元式生成，需要按照优先级依次匹配括号，乘除和加减。
之后实现的是if条件语句和while循环语句的四元式生成。在这一步中，需要考虑这里的括号与算数表达式中的括号意义不同，需要单独拿出来判断。
在设计过程中，考虑到条件判断语句和赋值语句的等号在生成四元式上有区别，考虑在每个新生成四元式后加上中间变量，便于调用，之后由优化部分进行修改，消去无用变量。
>a=b+c;
>
>(+,b,c,t0)
>
>(=,a,t0,t1)
>
>这里如果是条件判定语句就使用“t1”，否则“t1”无效。

在实现以上过程后，我进一步完成了对于整个函数输入与赋值的四元式生成。对于“int，float，char”等赋值以及函数的定义都有了相应的实现。
>int a;
>
>(int,a,,)
>
>int a=2;
>
>(int,a,,)(=,a,2,t1)
>
>int main()
>
>(int,mian,,)(func,,,)(end_f,,,)
>
>这里用func和end_f划分参数部分
>
>int f(int a=2)
>
>(int,f,,)(func,,,)(int,a,,)(=,a,2,t2)(end_f,,,)

在之后，为了更明确的划分每个块的位置，我引入了标记栈，在每个模块名压进栈，并在结束时出栈保存（遇到大括号“}”）。
这样对于整个输入程序的运行判断顺序又需要做新的调整。这时，括号“（）”的优先级不只存在于算数表达式中，此时我们将它拿出来单独分析匹配，在读到“）”后，将之前的内容匹配，直到读到“（”。
>int f()
>
>{a=b;}
>
>(int,f,,)(func,,,)(end_f,,,)
>
>(=,a,b,t3)
>
>(end,f,,)

---
### 2.遇到问题及解决
在生成四元式的过程中，我们加入了栈的操作，依靠其先入后出的特性完成了四元式的匹配。在此期间，遇到最多的问题是，往往会因为一些不起眼的栈操作而产生空栈，或者匹配结束，导致无法继续入栈出栈，程序强制结束。这里，我们对于每个模块，每条语句，在匹配时的栈操作要理解的非常清楚。于此同时，还需要特别注意每个调用后，最终数据是否归还到栈中，会不会对下一次调用产生影响。

由于在最开始没有明确的确定符号表接口，在之后进行了多次修改。对于符号表，目前只实现了一个很粗浅的调用。在生生成中间变量时建立新的符号表，按照运算内容保存他的类型。
在读到加减乘除以及等号等比较符号时，我们对符号两边的参数的类型进行比较，如果不相同就产生错误。

再者，还有有一个方面是对于一些算法一些编程技巧不太熟悉。我的整个代码的实现是相对较为复杂的。在全部完成后回过头看，很多地方原本可以用较为快捷的查找方式，但在实现时却是直接遍历，这就给程序运行添加了负担。同时，在有些地方，面对一个语句入栈，我不能很快的反应结果，需要看着这个语句想半天才有结果。在这个过程中，我对于这些部分还是不够敏锐，这就导致我花费了大量时间来完成代码。还好最终结果还算不错。

---
### 3.体会与思考
实现语义分析，我体会最深的其实是词法分析和语法分析的重要性。因为在我测试代码的过程中，看的最多的不是正确的语法得到内容，而是错误的句子生成错误的四元式，这也让我体会到，一个不起眼的语法错误会在编译时能产生多么大的影响。这就需要词法分析和语法分析确保输入语句的正确性，只有用词正确，语法正确，才能正确理解这个程序的意思。

其次我感受最多的是团队合作。以前也有实验，也有分组，但我基本选择的都是寝室的室友，基本上每天随时都能见面，有什么问题当面讨论，马上解决。但是在疫情条件下，各个组员不能直接见面讨论，对于一些内容变得不那么容易理解，也就不那么容易达成共识。我们在实验课上讨论时，也总有疏忽和遗漏，而线下单独交流，也会有没看到消息等一系列问题，这也就导致了我们最终整合代码的时间不那么充裕，对更深一层的实现也没有落实。所以在团队中，及时全面的交流真的很重要。

最后是我在这次课设中的一些收获。
首先，无论是Github的使用，还是md文件markdown语法的编写，都是我之前完全没有涉及的领域，现在都得到了很好的掌握。老师选择使用GitHub平台，虽然比起我们以往直接上传内容显得较为复杂，但还是可以看出老师们的良苦用心。同时，虽然我们只完成了编译器前端，但其实对于后端的内容我们都有了一个初步的了解，对于整个编译器的工作也有了更深刻的认识。在编译实验中，我不仅学习了编译的技能，还对于一些算法有了主动的认识，它们可能于这次编译无关，但至少给了我一个接触它们的契机，让我掌握更多的东西。

与此同时，老师安排的报告也让我受益匪浅。在这个阶段，我对于未来的规划，其实还是有些迷茫的，这些报告，都能在一定程度上帮助我们更加了解这个专业以及相关的职业，未来的发展方向。虽然其中一些内容较为深入，但也告诉了我们这样的职业需要面对什么。感谢老师的精心安排，让我们的职业规划和发展方向有了一个明确的选择。

编译课设告一段落，但我相信，在这两周里学到的知识将一直陪伴着我，攀登新的高峰。
